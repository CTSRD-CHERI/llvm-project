; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: %cheri_purecap_llc -o - %s | %cheri_FileCheck %s

; Crash found while compiling rust-generated code:
declare { i32 addrspace(200)*, i32 addrspace(200)* } @"_ZN13libcore_cheri5slice29_$LT$impl$u20$$u5b$T$u5d$$GT$4iter17h36a7eda044ca512cE"(i32 addrspace(200)*, i128) addrspace(200)

define void @a() nounwind {
; CHECK-LABEL: a:
; CHECK:       # %bb.0:
; CHECK-NEXT:    cincoffset $c11, $c11, -[[#STACKFRAME_SIZE:]]
; CHECK-NEXT:    csc $c17, $zero, [[#STACKFRAME_SIZE - (#CAP_SIZE)]]($c11)
; CHECK-NEXT:    lui $1, %hi(%neg(%captab_rel(a)))
; CHECK-NEXT:    daddiu $1, $1, %lo(%neg(%captab_rel(a)))
; CHECK-NEXT:    cincoffset $c1, $c12, $1
; CHECK-NEXT:    clcbi $c12, %capcall20(_ZN13libcore_cheri5slice29_$LT$impl$u20$$u5b$T$u5d$$GT$4iter17h36a7eda044ca512cE)($c1)
; CHECK-NEXT:    cincoffset $c3, $c11, {{0|32}}
; CHECK-NEXT:    cgetnull $c4
; CHECK-NEXT:    daddiu $4, $zero, 0
; CHECK-NEXT:    cjalr $c12, $c17
; CHECK-NEXT:    daddiu $5, $zero, 6
; CHECK-NEXT:    clc $c17, $zero, [[#STACKFRAME_SIZE - (#CAP_SIZE)]]($c11)
; CHECK-NEXT:    cjr $c17
; CHECK-NEXT:    cincoffset $c11, $c11, [[#STACKFRAME_SIZE]]
  call { i32 addrspace(200)*, i32 addrspace(200)* } @"_ZN13libcore_cheri5slice29_$LT$impl$u20$$u5b$T$u5d$$GT$4iter17h36a7eda044ca512cE"(i32 addrspace(200)* null, i128 6)
  ret void
}
