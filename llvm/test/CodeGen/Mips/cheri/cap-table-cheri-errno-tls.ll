; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: %cheri_purecap_llc -o - -O2 -cheri-cap-table-abi=plt - < %s | FileCheck %s -check-prefix CAPTABLE

@cheri_errno = external thread_local(initialexec) addrspace(200) global i32, align 4

; Function Attrs: noinline nounwind optnone
define void @test_sandbox_cs_clock_gettime_default() #0 {
; CAPTABLE-LABEL: test_sandbox_cs_clock_gettime_default:
; CAPTABLE:       # %bb.0: # %entry
; CAPTABLE-NEXT:    lui $1, %captab_tprel_hi(cheri_errno)
; CAPTABLE-NEXT:    daddiu $1, $1, %captab_tprel_lo(cheri_errno)
; CAPTABLE-NEXT:    cld $1, $1, 0($c26)
; CAPTABLE-NEXT:    creadhwr $c1, $chwr_userlocal
; CAPTABLE-NEXT:    addiu $2, $zero, 0
; CAPTABLE-NEXT:    csw $zero, $1, 0($c1)
entry:
  store i32 0, i32 addrspace(200)* @cheri_errno, align 4
  unreachable
}

attributes #0 = { noinline nounwind optnone }
